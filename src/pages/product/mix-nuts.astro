---
import BaseLayout from '../../layouts/BaseLayout.astro';
import { getProductByCode } from '../../data/products';

const product = getProductByCode('mix-nuts')!;

const jsonLd = {
  '@context': 'https://schema.org',
  '@type': 'Product',
  name: product.name,
  image: `https://riofarm.vn${product.image}`,
  description: product.description,
  brand: { '@type': 'Brand', name: 'Rio Farm' },
  offers: {
    '@type': 'Offer',
    price: product.price,
    priceCurrency: 'VND',
    availability: 'https://schema.org/InStock',
    seller: { '@type': 'Organization', name: 'Rio Farm' },
  },
};
---

<BaseLayout
  title="H·∫°t Mix | Rio Farm"
  description="H·ªón h·ª£p h·∫°t dinh d∆∞·ª°ng Rio Farm - K·∫øt h·ª£p macadamia v√† c√°c lo·∫°i h·∫°t kh√°c, gi√†u dinh d∆∞·ª°ng v√† th∆°m ngon."
  canonical="https://riofarm.vn/product/mix-nuts"
  ogType="product"
  ogImage={product.image}
  jsonLd={jsonLd}
>
  <div class="container-large product-shell">
    <nav class="breadcrumbs" aria-label="Breadcrumb">
      <a href="/">Trang ch·ªß</a><span>‚Ä∫</span>
      <span id="product-name">{product.name}</span>
    </nav>

    <div class="product-content">
      <!-- Gallery -->
      <div>
        <img
          src={product.gallery[0].image}
          alt={product.gallery[0].alt}
          style="width:100%;border-radius:12px;aspect-ratio:4/3;object-fit:cover;"
          loading="eager"
        />
      </div>

      <!-- Details -->
      <div>
        <h1 class="product-name">{product.name}</h1>
        <p class="product-vendor">b·ªüi <strong>{product.vendor}</strong></p>

        <div id="product-price-label" class="product-price-label">
          Li√™n h·ªá
        </div>

        <p class="product-copy">{product.description}</p>

        <!-- Nutrition & Detail Section -->
        <div style="margin:1.5rem 0;border:1px solid #eee;border-radius:10px;overflow:hidden;font-size:0.9rem;">
          <div style="background:var(--gold);padding:0.6rem 1rem;">
            <strong>Th√¥ng tin dinh d∆∞·ª°ng</strong> <span style="font-weight:400;font-size:0.8rem;">(per 28g ‚Äî h·ªón h·ª£p)</span>
          </div>
          <table style="width:100%;border-collapse:collapse;">
            <tbody>
              {[
                ['NƒÉng l∆∞·ª£ng', '~170 kcal'],
                ['Ch·∫•t b√©o t·ªïng', '~15 g'],
                ['‚Äî Ch·∫•t b√©o kh√¥ng b√£o h√≤a', '~10 g'],
                ['Protein', '~5 g'],
                ['Carbohydrate', '~7 g'],
                ['Ch·∫•t x∆°', '~2 g'],
                ['Vitamin E', '~2 mg'],
                ['Magi√™', '~45 mg'],
                ['K·∫Ωm', '~1 mg'],
              ].map(([label, value], i) => (
                <tr style={`background:${i % 2 === 0 ? '#fafafa' : '#fff'};`}>
                  <td style="padding:0.45rem 1rem;color:#444;">{label}</td>
                  <td style="padding:0.45rem 1rem;text-align:right;font-weight:600;">{value}</td>
                </tr>
              ))}
            </tbody>
          </table>
        </div>

        <!-- Key Benefits -->
        <ul style="margin:1rem 0 1.5rem;padding-left:1.25rem;line-height:2;font-size:0.9rem;color:#444;">
          <li>üåà ƒêa d·∫°ng dinh d∆∞·ª°ng ‚Äî m·ªói lo·∫°i h·∫°t ƒë√≥ng g√≥p vi ch·∫•t ri√™ng bi·ªát</li>
          <li>üí™ Protein v√† ch·∫•t b√©o l√†nh m·∫°nh ‚Äî duy tr√¨ c∆° b·∫Øp v√† nƒÉng l∆∞·ª£ng b·ªÅn v·ªØng</li>
          <li>üß† H·ªó tr·ª£ n√£o b·ªô ‚Äî omega-3 t·ª´ √≥c ch√≥, B-vitamin t·ª´ h·∫°nh nh√¢n</li>
          <li>üéÅ Th√≠ch h·ª£p l√†m qu√† bi·∫øu ‚Äî sang tr·ªçng, ti·ªán l·ª£i, √Ω nghƒ©a s·ª©c kh·ªèe</li>
          <li>‚ö° Snack nhanh l√Ω t∆∞·ªüng ‚Äî no l√¢u, ti·ªán mang ƒëi, kh√¥ng c·∫ßn ch·∫ø bi·∫øn</li>
        </ul>

        <div style="margin-bottom:1rem;">
          <label for="qty" class="product-qty-label">S·ªë l∆∞·ª£ng</label>
          <input id="qty" type="number" min="1" value="1" class="product-qty-input" />
        </div>
        <div class="product-actions">
          <button id="add-to-cart" class="btn-secondary" style="width:100%;">Th√™m v√†o gi·ªè</button>
          <button id="buy-now" class="btn-primary" style="width:100%;">Mua ngay</button>
        </div>
        <p id="cart-feedback" style="font-size:0.9rem;color:var(--gold-dark);margin-top:0.75rem;"></p>
      </div>
    </div>

    <div class="blog-content" style="max-width:860px;margin:3rem auto 0;">
      <h2>H·∫°t Mix Rio Farm - ƒêa d·∫°ng dinh d∆∞·ª°ng</h2>
      <p>
        H·ªón h·ª£p h·∫°t dinh d∆∞·ª°ng c·ªßa Rio Farm bao g·ªìm macadamia v√† c√°c lo·∫°i h·∫°t t·ª± nhi√™n kh√°c ƒë∆∞·ª£c tuy·ªÉn ch·ªçn k·ªπ c√†ng.
        M·ªói lo·∫°i h·∫°t mang ƒë·∫øn m·ªôt h∆∞∆°ng v·ªã v√† gi√° tr·ªã dinh d∆∞·ª°ng ƒë·ªôc ƒë√°o.
      </p>

      <h2>Th√†nh ph·∫ßn</h2>
      <ul style="list-style-type:circle;margin-left:1.2rem;">
        <li>H·∫°t macadamia s·∫•y - gi√†u omega, b√©o b√πi</li>
        <li>H·∫°t ƒëi·ªÅu - gi√†u protein v√† ch·∫•t b√©o t·ªët</li>
        <li>H·∫°t √≥c ch√≥ - gi√†u omega-3, t·ªët cho n√£o</li>
        <li>H·∫°nh nh√¢n - gi√†u vitamin E v√† magie</li>
      </ul>

      <h2>L·ª£i √≠ch s·ª©c kh·ªèe</h2>
      <ul style="list-style-type:circle;margin-left:1.2rem;">
        <li>Cung c·∫•p nƒÉng l∆∞·ª£ng b·ªÅn v·ªØng</li>
        <li>H·ªó tr·ª£ s·ª©c kh·ªèe tim m·∫°ch</li>
        <li>Gi√†u ch·∫•t ch·ªëng oxy h√≥a</li>
        <li>T·ªët cho h·ªá th·∫ßn kinh v√† n√£o b·ªô</li>
        <li>Ph√π h·ª£p l√†m snack l√†nh m·∫°nh</li>
      </ul>

      <div style="text-align:center;margin:1.5rem 0;">
        <img src="/products/hat_mix.jpg" alt="H·∫°t mix Rio Farm" style="max-width:400px;width:100%;border-radius:8px;" loading="lazy" />
      </div>
    </div>
    <script type="application/json" id="product-json" set:html={JSON.stringify(product)}></script>
    <script>
      const dataEl = document.getElementById('product-json');
      const addBtn = document.getElementById('add-to-cart');
      const buyNowBtn = document.getElementById('buy-now');
      const qtyEl = document.getElementById('qty');
      const feedback = document.getElementById('cart-feedback');
      const productData = dataEl ? JSON.parse(dataEl.textContent || '{}') : null;

      function addToCart(redirectToCheckout = false) {
        if (!window.RioCart || !productData) return;
        const qty = Math.max(1, Number(qtyEl?.value || 1));
        window.RioCart.addToCart(productData, qty);
        if (feedback) feedback.textContent = `ƒê√£ th√™m ${qty} s·∫£n ph·∫©m v√†o gi·ªè h√†ng`;
        if (redirectToCheckout) window.location.href = '/checkout';
      }

      addBtn?.addEventListener('click', () => addToCart(false));
      buyNowBtn?.addEventListener('click', () => addToCart(true));
    </script>
  </div>
</BaseLayout>
