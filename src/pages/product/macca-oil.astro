---
import BaseLayout from '../../layouts/BaseLayout.astro';
import { getProductByCode } from '../../data/products';

const product = getProductByCode('macca-oil')!;

const jsonLd = {
  '@context': 'https://schema.org',
  '@type': 'Product',
  name: product.name,
  image: `https://riofarm.vn${product.image}`,
  description: product.description,
  brand: { '@type': 'Brand', name: 'Rio Farm' },
  offers: {
    '@type': 'Offer',
    price: product.price,
    priceCurrency: 'VND',
    availability: 'https://schema.org/InStock',
    seller: { '@type': 'Organization', name: 'Rio Farm' },
  },
};
---

<BaseLayout
  title="D·∫ßu Macca | Rio Farm"
  description="D·∫ßu macadamia √©p l·∫°nh Rio Farm - Gi√†u omega, t·ªët cho tim m·∫°ch. S·∫£n xu·∫•t t·∫°i L√¢m H√†, L√¢m ƒê·ªìng."
  canonical="https://riofarm.vn/product/macca-oil"
  ogType="product"
  ogImage={product.image}
  jsonLd={jsonLd}
>
  <div class="container-large product-shell">
    <nav class="breadcrumbs" aria-label="Breadcrumb">
      <a href="/">Trang ch·ªß</a><span>‚Ä∫</span>
      <span id="product-name">{product.name}</span>
    </nav>

    <div class="product-content">
      <!-- Gallery -->
      <div>
        <img
          src={product.gallery[0].image}
          alt={product.gallery[0].alt}
          style="width:100%;border-radius:12px;aspect-ratio:4/3;object-fit:cover;"
          loading="eager"
        />
      </div>

      <!-- Details -->
      <div>
        <h1 class="product-name">{product.name}</h1>
        <p class="product-vendor">b·ªüi <strong>{product.vendor}</strong></p>

        <div id="product-price-label" class="product-price-label">
          Li√™n h·ªá
        </div>

        <p class="product-copy">{product.description}</p>

        <!-- Nutrition & Detail Section -->
        <div style="margin:1.5rem 0;border:1px solid #eee;border-radius:10px;overflow:hidden;font-size:0.9rem;">
          <div style="background:var(--gold);padding:0.6rem 1rem;">
            <strong>Th√¥ng tin dinh d∆∞·ª°ng</strong> <span style="font-weight:400;font-size:0.8rem;">(per 1 mu·ªóng canh / 14g)</span>
          </div>
          <table style="width:100%;border-collapse:collapse;">
            <tbody>
              {[
                ['NƒÉng l∆∞·ª£ng', '124 kcal'],
                ['Ch·∫•t b√©o t·ªïng', '14 g'],
                ['‚Äî Ch·∫•t b√©o kh√¥ng b√£o h√≤a ƒë∆°n (MUFA)', '11.3 g (81%)'],
                ['‚Äî Ch·∫•t b√©o kh√¥ng b√£o h√≤a ƒëa (PUFA)', '0.4 g'],
                ['‚Äî Ch·∫•t b√©o b√£o h√≤a', '2.2 g'],
                ['Vitamin E', '0.5 mg'],
                ['ƒêi·ªÉm b·ªëc kh√≥i', '~210¬∞C (ph√π h·ª£p chi√™n, x√†o nh·∫π)'],
              ].map(([label, value], i) => (
                <tr style={`background:${i % 2 === 0 ? '#fafafa' : '#fff'};`}>
                  <td style="padding:0.45rem 1rem;color:#444;">{label}</td>
                  <td style="padding:0.45rem 1rem;text-align:right;font-weight:600;">{value}</td>
                </tr>
              ))}
            </tbody>
          </table>
        </div>

        <!-- Key Benefits -->
        <ul style="margin:1rem 0 1.5rem;padding-left:1.25rem;line-height:2;font-size:0.9rem;color:#444;">
          <li>ü´Ä Gi√†u omega-9 (oleic acid) ‚Äî h·ªó tr·ª£ tim m·∫°ch, ch·ªëng vi√™m t·ª± nhi√™n</li>
          <li>üç≥ ƒêi·ªÉm b·ªëc kh√≥i cao ~210¬∞C ‚Äî an to√†n cho chi√™n x√†o, kh√¥ng sinh ƒë·ªôc ch·∫•t</li>
          <li>üíÜ D∆∞·ª°ng da v√† t√≥c ‚Äî th·∫•m nhanh, kh√¥ng nh·ªùn, ph√π h·ª£p d√πng tr·ª±c ti·∫øp l√™n da</li>
          <li>ü•ó Thay th·∫ø d·∫ßu √¥ liu ‚Äî h∆∞∆°ng nh·∫π, kh√¥ng √°t m√πi th·ª©c ƒÉn</li>
          <li>üåø Kh√¥ng ch·∫•t b·∫£o qu·∫£n, kh√¥ng bi·∫øn ƒë·ªïi gen</li>
        </ul>

        <div style="margin-bottom:1rem;">
          <label for="qty" class="product-qty-label">S·ªë l∆∞·ª£ng</label>
          <input id="qty" type="number" min="1" value="1" class="product-qty-input" />
        </div>
        <div class="product-actions">
          <button id="add-to-cart" class="btn-secondary" style="width:100%;">Th√™m v√†o gi·ªè</button>
          <button id="buy-now" class="btn-primary" style="width:100%;">Mua ngay</button>
        </div>
        <p id="cart-feedback" style="font-size:0.9rem;color:var(--gold-dark);margin-top:0.75rem;"></p>
      </div>
    </div>

    <div class="blog-content" style="max-width:860px;margin:3rem auto 0;">
      <h2>D·∫ßu Macadamia - Tinh hoa t·ª´ thi√™n nhi√™n</h2>
      <p>
        D·∫ßu macadamia ƒë∆∞·ª£c √©p l·∫°nh t·ª´ h·∫°t macadamia t∆∞∆°i ngay t·∫°i c∆° s·ªü Rio Macca L√¢m H√†. D·∫ßu gi√†u omega-7 (axit palmitoleic)
        - lo·∫°i axit b√©o hi·∫øm c√≥ kh·∫£ nƒÉng nu√¥i d∆∞·ª°ng da, ch·ªëng l√£o h√≥a v√† b·∫£o v·ªá tim m·∫°ch.
      </p>
      <p>
        D·∫ßu macadamia c·ªßa Rio Farm ƒë∆∞·ª£c s·∫£n xu·∫•t theo quy tr√¨nh √©p l·∫°nh, ƒë·∫£m b·∫£o gi·ªØ l·∫°i t·ªëi ƒëa d∆∞·ª°ng ch·∫•t t·ª± nhi√™n.
        Kh√¥ng s·ª≠ d·ª•ng h√≥a ch·∫•t hay ch·∫•t b·∫£o qu·∫£n nh√¢n t·∫°o.
      </p>

      <h2>C√¥ng d·ª•ng c·ªßa d·∫ßu macadamia</h2>
      <ul style="list-style-type:circle;margin-left:1.2rem;">
        <li>T·ªët cho tim m·∫°ch - gi√†u axit b√©o kh√¥ng b√£o h√≤a ƒë∆°n</li>
        <li>H·ªó tr·ª£ ki·ªÉm so√°t c√¢n n·∫∑ng</li>
        <li>Nu√¥i d∆∞·ª°ng da v√† t√≥c</li>
        <li>Ch·ªëng oxy h√≥a m·∫°nh</li>
        <li>Th√≠ch h·ª£p d√πng trong n·∫•u ƒÉn ·ªü nhi·ªát ƒë·ªô cao</li>
      </ul>

      <div style="text-align:center;margin:1.5rem 0;">
        <img src="/products/dau-macca.jpg" alt="D·∫ßu macca Rio Farm" style="max-width:400px;width:100%;border-radius:8px;" loading="lazy" />
      </div>
    </div>
    <script type="application/json" id="product-json" set:html={JSON.stringify(product)}></script>
    <script>
      const dataEl = document.getElementById('product-json');
      const addBtn = document.getElementById('add-to-cart');
      const buyNowBtn = document.getElementById('buy-now');
      const qtyEl = document.getElementById('qty');
      const feedback = document.getElementById('cart-feedback');
      const productData = dataEl ? JSON.parse(dataEl.textContent || '{}') : null;

      function addToCart(redirectToCheckout = false) {
        if (!window.RioCart || !productData) return;
        const qty = Math.max(1, Number(qtyEl?.value || 1));
        window.RioCart.addToCart(productData, qty);
        if (feedback) feedback.textContent = `ƒê√£ th√™m ${qty} s·∫£n ph·∫©m v√†o gi·ªè h√†ng`;
        if (redirectToCheckout) window.location.href = '/checkout';
      }

      addBtn?.addEventListener('click', () => addToCart(false));
      buyNowBtn?.addEventListener('click', () => addToCart(true));
    </script>
  </div>
</BaseLayout>
