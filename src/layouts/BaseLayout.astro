---
import '../styles/global.css';
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';
import SEO from '../components/SEO.astro';

export interface Props {
  title: string;
  description: string;
  canonical?: string;
  ogType?: string;
  ogImage?: string;
  noindex?: boolean;
  jsonLd?: object;
  noPaddingBottom?: boolean;
}

const {
  title,
  description,
  canonical,
  ogType,
  ogImage,
  noindex,
  jsonLd,
  noPaddingBottom = false,
} = Astro.props;
---

<!doctype html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <SEO
      title={title}
      description={description}
      canonical={canonical}
      ogType={ogType}
      ogImage={ogImage}
      noindex={noindex}
      jsonLd={jsonLd}
    />
    <script is:inline src="/cart.js"></script>
  </head>
  <body>
    <Header />
    <main class="main-content" style={noPaddingBottom ? 'padding-bottom:0' : ''}>
      <slot />
    </main>
    <Footer />

    <!-- Zalo Floating Button -->
    <a
      href="https://zalo.me/0977742047"
      target="_blank"
      rel="noopener noreferrer"
      class="zalo-float"
      aria-label="Liên hệ Zalo Rio Farm"
      title="Nhắn Zalo cho chúng tôi"
    >
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 64" width="28" height="28" fill="none" aria-hidden="true">
        <rect x="2" y="2" width="60" height="60" rx="20" fill="#0068ff" />
        <path d="M18 22c0-2.2 1.8-4 4-4h20c2.2 0 4 1.8 4 4v16c0 2.2-1.8 4-4 4H29l-7 6v-6c-2.2 0-4-1.8-4-4V22z" fill="#fff"/>
        <text x="32" y="34" text-anchor="middle" fill="#0068ff" font-size="11" font-weight="800" font-family="Arial,sans-serif">Zalo</text>
      </svg>
      <span class="zalo-label">Zalo</span>
    </a>

    <style>
      .zalo-float {
        position: fixed;
        bottom: 24px;
        right: 24px;
        z-index: 160;
        display: flex;
        align-items: center;
        gap: 8px;
        background: #0068ff;
        color: #fff;
        border-radius: 50px;
        padding: 10px 18px 10px 12px;
        text-decoration: none;
        font-weight: 700;
        font-size: 0.95rem;
        box-shadow: 0 4px 18px rgba(0,104,255,0.45);
        animation: zalo-pulse 2.2s ease-in-out infinite;
        transition: transform 0.2s, box-shadow 0.2s, opacity .2s ease;
      }

      .zalo-float:hover {
        transform: scale(1.07);
        box-shadow: 0 6px 24px rgba(0,104,255,0.6);
        animation: none;
      }

      .zalo-label {
        letter-spacing: 0.03em;
      }

      @keyframes zalo-pulse {
        0%, 100% { box-shadow: 0 4px 18px rgba(0,104,255,0.45); }
        50% { box-shadow: 0 4px 30px rgba(0,104,255,0.75), 0 0 0 8px rgba(0,104,255,0.12); }
      }

      :global(body.cart-open) .zalo-float {
        opacity: 0;
        pointer-events: none;
        transform: translateY(8px);
      }

      @media (max-width: 480px) {
        .zalo-float {
          bottom: 16px;
          right: 16px;
          padding: 10px 14px 10px 10px;
          font-size: 0.85rem;
        }
      }
    </style>
  </body>
</html>
